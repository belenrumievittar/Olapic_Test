#Previously to make the forecast, we have to define the variables.#
#We will work with data by Customer. However, as we need at least 100 observations for each one, we will build a variable "rest of customers" to clustered all the customers that donÂ´t have data enough).#

#We can use 2 kind of models:#
#1) Garch Models: when we have not an explicative variable, so the estimation depend on the past variability. In this case we will use Step3 as variable.#
#2) Regression Models: in this case we will explain the Step 3 as function of the Step1.#

#Variables#

Step1_215934= c(3,4,2,2,2,4,11,6,4,4,3,4,4,5,2,2,2,4,2,2,4,8,4,4,2,2,2,2,2,2,3,2,2,2,2,2,4,2,2,2,2,2,4,2,15,2,6,4,3,2,2,2,2,3,2,2,3,5,3,2,2,2,3,5,8,2,4,8,2,4,6,2,3,2,2,2,2,2,2,2,2,14,2,6,2,2,2,2,5,3,2,2,4,2,2,2,2,2,2,4,2,2,2,2,2,3,2,4,2,2,2,2,2,2,2,2,2,2,2,2,2,4,2,2,2,2,2,2,2,6,3,2,2,2,2,2,2,2,2,2,4,2,3,3,2,2,5,10,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,4,2,2,2,6,4,2,6,4,2,2,2,2,2,2,2,3,2,2,2,4,2,2,2,2,2,6,2,2,2,3,2,2,5,2,3,2,4,2,7,2,2,2,2,2,4,2,2,6,2,2,3,2,2,2,2,4,2,4,2,2,2,2,2,5,3,2,2,4,2,2,2,2,3,3,2,2,7,3,2,2,9,2,2,2,2,2,2,2,2,2,4,2,2,2,2,2,2,6,2,2,2,2,3,2,5,2,2,2,3,2,3,2,2,2,2,2,2,4,2,2,2,2,2,2,4,2,2,3,9,2,2,2,2,3,2,5,9,6,5,2,2,6,2,7,2,10,7,2,2,2,2,2,2,4,2,2,2,2,5,2,2,2,2,6,2,2,2,3,2,2,8,5,24,2,3,6,2,4,4,2,3,6,4,2,6,5,2,3,3,2,4,4,4,2,2,3,2,2,2,2,2,2,2,4,2,3,2,2,2,2,2,2,2,2,4,2,2,6,2,2)
Step3_215934= c(0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0)
#Step3_Step1_215934=c(0,0,0,0,0,0,0,0,0,0,0,0.25,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.142857142857143,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.5,0,0,0)#
#Revenue_215934=c(0,0,0,0,0,0,0,0,0,0,0,559,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,56,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,47,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,253,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0)#
#Revenue_Step1_215934=c(0,0,0,0,0,0,0,0,0,0,0,139.75,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,28,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6.71428571428571,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,126.5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1.5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,32,0,0,0)#

Step1_216178=c(2,2,6,2,4,2,2,6,2,7,4,2,2,3,17,2,8,2,2,8,2,2,7,2,3,8,2,2,2,2,2,2,2,2,2,2,2,2,6,2,11,5,2,4,31,6,2,3,2,2,2,2,2,2,2,2,4,2,2,18,2,2,5,9,12,13,2,4,9,2,2,3,6,2,3,5,4,6,4,4,11,3,12,13,10,3,46,14,2,50,2,2,5,2,13,19,92,52,13,42,108,31,17,14,9,7,2,9,21,22,6,6,15,8,4,37,20,36,225,12,14,14,11,95,113,57,197,44,47,41,13,116,7,51,77,27,24,2,38,43,31,34,36,76,26,172,375,261,9,9,49,12,175,290,47,326,91,56,21,16,18,148,57,14,5,9,15,9,7,152,55,99,10,144,3,42,7,145,4,159,42,2,11,17,33,20,2,43,6,2,119,115,659,2,17,3,3,4,166,117,185,82,209,18,9,45,32,82,36,226,2,6,11,22,14,22,9,94,15,8)
Step3_216178=c(0,0,0,0,0,0,0,0,0,1,0,0,0,0,4,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,2,0,0,3,0,0,0,0,0,0,8,3,0,2,10,0,0,0,0,0,0,0,0,0,0,0,0,1,0,3,0,4,23,0,0,1,0,4,3,9,46,11,6,4,1,41,1,2,11,0,0,0,5,0,8,1,3,8,0,27,41,88,0,0,3,0,9,61,0,43,23,9,3,3,0,14,0,0,0,0,1,0,0,15,2,4,0,14,0,6,0,32,0,21,4,0,1,1,1,1,0,1,0,0,14,8,169,0,1,0,0,0,26,21,18,6,29,0,0,2,0,2,1,47,0,0,0,0,4,1,1,13,7,1)
#Step3_Step1_216178=c(0,0,0,0,0,0,0,0,0,0.142857142857143,0,0,0,0,0.235294117647059,0,0.125,0,0,0,0,0,0,0,0,0.125,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.129032258064516,0,0,0,0,0,0,0,0,0,0,0,0,0.5,0,0.0555555555555556,0,0,0,0,0,0.0769230769230769,0,0,0,0,0,0,0,0,0,0.2,0,0,0,0,0,0,0,0,0,0,0.0434782608695652,0,0,0.06,0,0,0,0,0,0,0.0869565217391304,0.0576923076923077,0,0.0476190476190476,0.0925925925925926,0,0,0,0,0,0,0,0,0,0,0,0,0.125,0,0.0810810810810811,0,0.111111111111111,0.102222222222222,0,0,0.0714285714285714,0,0.0421052631578947,0.0265486725663717,0.157894736842105,0.233502538071066,0.25,0.127659574468085,0.0975609756097561,0.0769230769230769,0.353448275862069,0.142857142857143,0.0392156862745098,0.142857142857143,0,0,0,0.131578947368421,0,0.258064516129032,0.0294117647058824,0.0833333333333333,0.105263157894737,0,0.156976744186047,0.109333333333333,0.337164750957854,0,0,0.0612244897959184,0,0.0514285714285714,0.210344827586207,0,0.131901840490798,0.252747252747253,0.160714285714286,0.142857142857143,0.1875,0,0.0945945945945946,0,0,0,0,0.0666666666666667,0,0,0.0986842105263158,0.0363636363636364,0.0404040404040404,0,0.0972222222222222,0,0.142857142857143,0,0.220689655172414,0,0.132075471698113,0.0952380952380952,0,0.0909090909090909,0.0588235294117647,0.0303030303030303,0.05,0,0.0232558139534884,0,0,0.117647058823529,0.0695652173913043,0.256449165402124,0,0.0588235294117647,0,0,0,0.156626506024096,0.179487179487179,0.0972972972972973,0.0731707317073171,0.138755980861244,0,0,0.0444444444444444,0,0.024390243902439,0.0277777777777778,0.207964601769911,0,0,0,0,0.285714285714286,0.0454545454545455,0.111111111111111,0.138297872340426,0.466666666666667,0.125)#
#Revenue_216178=c0,0,0,0,0,0,0,0,0,88,0,0,0,0,632,0,134.4,0,0,0,0,0,0,0,0,237,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,508.3,0,0,0,0,0,0,0,0,0,0,0,0,78.4,0,54.4,0,0,0,0,0,24,0,0,0,0,0,0,0,0,0,103.5,0,0,0,0,0,0,0,0,0,0,667.18,0,0,425.8,0,0,0,0,0,0,797.16,168.8,0,142.36,1220.15,0,0,0,0,0,0,0,0,0,0,0,0,94.4,0,272,0,415.91,2300.47,0,0,54.4,0,518.8,260.65,626.56,4333.87,901.11,384.55,444,54.4,4475.16,134.4,195.92,900.66,0,0,0,487.32,0,680.98,94.4,404.8,914.75,0,2603.02,3816,8217.86,0,0,339.99,0,887.34,6275.89,0,4638.42,1862.35,667.16,334.35,187.2,0,916.05,0,0,0,0,158,0,0,1345.78,30.4,373.95,0,1759.12,0,581,0,2619.86,0,1447.03,460,0,40,16,99.95,348,0,50,0,0,843.35,691.4,21064.54,0,100,0,0,0,2149.18,619.99,2683.4,784,2340.2,0,0,61.95,0,296,37.9,4006.76,0,0,0,0,67,59.96,118,1416.71,815.5,126)#
#Revenue_Step1_216178=c(0,0,0,0,0,0,0,0,0,12.5714285714286,0,0,0,0,37.1764705882353,0,16.8,0,0,0,0,0,0,0,0,29.625,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16.3967741935484,0,0,0,0,0,0,0,0,0,0,0,0,39.2,0,3.02222222222222,0,0,0,0,0,1.84615384615385,0,0,0,0,0,0,0,0,0,20.7,0,0,0,0,0,0,0,0,0,0,14.5039130434783,0,0,8.516,0,0,0,0,0,0,8.66478260869565,3.24615384615385,0,3.38952380952381,11.2976851851852,0,0,0,0,0,0,0,0,0,0,0,0,11.8,0,7.35135135135135,0,11.5530555555556,10.2243111111111,0,0,3.88571428571429,0,5.46105263157895,2.30663716814159,10.9922807017544,21.9993401015228,20.4797727272727,8.18191489361702,10.8292682926829,4.18461538461538,38.5789655172414,19.2,3.84156862745098,11.6968831168831,0,0,0,12.8242105263158,0,21.9670967741935,2.77647058823529,11.2444444444444,12.0361842105263,0,15.1338372093023,10.176,31.4860536398467,0,0,6.93857142857143,0,5.07051428571429,21.641,0,14.228282208589,20.4653846153846,11.9135714285714,15.9214285714286,11.7,0,6.18952702702703,0,0,0,0,10.5333333333333,0,0,8.85381578947368,0.552727272727273,3.77727272727273,0,12.2161111111111,0,13.8333333333333,0,18.068,0,9.10081761006289,10.952380952381,0,3.63636363636364,0.941176470588235,3.02878787878788,17.4,0,1.16279069767442,0,0,7.08697478991597,6.01217391304348,31.9644006069803,0,5.88235294117647,0,0,0,12.9468674698795,5.29905982905983,14.5048648648649,9.5609756097561,11.1971291866029,0,0,1.37666666666667,0,3.60975609756098,1.05277777777778,17.7290265486726,0,0,0,0,4.78571428571429,2.72545454545455,13.1111111111111,15.0713829787234,54.3666666666667,15.75)#

Step1_Rest_of_costumers=c(5,2,9,5,2,2,10,2,2,2,9,2,2,5,2,2,2,5,2,2,5,3,4,2,5,2,12,8,2,2,2,2,2,2,2,5,6,4,9,4,2,2,2,4,9,2,2,6,4,2,4,2,18,33,2,25,2,2,2,27,2,5,13,21,16,4,2,2,3,2,2,3,2,4,14,3,6,2,2,2,2,5,9,14,2,6,66,3,3,11,4,3,2,2,2,6,3,11,9,2,13,27,3,5,4,16,6,2,2,2,2,2,5,4,4,6,2,2,3,2,5,2,2,2,2,2,2,2,9,2,2,2,2,2,2,11,2,2,2,9,2,2,10,2,2,4,2,37,2,11,2,2,2,2,4,8,2,2,2,2,2,2,19,2,8,22,10,2,2,2,2,4,2,7,2,12,2,63,2,264,2,6,2,2,2,2,2,2,2,3,3,2,2,2,2,10,2,2,2,7,2,3,2,7,2,6,2,12,4,2,3,2,2,2,4,4,2,6,3,3,4,2,2,2,6,2,9,2,2,2,2,2,2,2,2,2,2,2,2,4,2,4,2,9,2,4,2,4,2,4,14,4,4,2,2,2,3,3,2,2,2,2,2,3,2,2,2,8,2,11,2,4,8,2,2,2,3,2,2,2,2,4,7,3,5,2,2,7,2,2,4,2,2,2,6,2,2,2,8,5,4,4,2,2,2,13,2,13,4,5,2,3,32,2,2,2,2,4,4,6,3,5,2,81,3,2,6,4,2,2,8,2,5,9,6,2,2,2,12,6,5,2,4,2,24,2,7,2,2,11,9,12,2,9,34,24,5,2,7,2,5,9,3,31,2,9,2,9,2,109,2,5,2,17,6,11,12,2,4,7,13,205,4,8,12,2,76,2,3,6,34,2,12,2,26,3,6,2,2,2,9)
Step3_Rest_of_costumers=c(0,0,0,0,0,0,2,0,0,0,1,0,0,0,0,0,1,0,0,0,1,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,2,0,1,0,2,2,0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,0,0,3,0,0,0,3,1,5,1,1,0,0,0,0,0,0,0,0,0,6,3,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,1,0,0,0,0,0,0,0,0,3,0,0,0,0,13,0,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,1,0,52,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,2,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,4,0,0,0,0,3,1,0,0,1,0,0,0,0,0,0,14,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,3,0,0,0,0,1,0,0,0,1,5,2,0,0,0,0,0,1,0,4,0,0,0,0,2,22,0,0,1,1,0,1,1,0,0,1,0,50,0,1,0,0,11,0,0,1,9,0,0,0,1,0,0,0,0,0,1)
#Step3_Step1_Rest_of_costumers=c(0,0,0,0,0,0,0.2,0,0,0,0.111111111111111,0,0,0,0,0,0.5,0,0,0,0.2,0,0,0,0.4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.25,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.16,0,0,0,0.0740740740740741,0,0.2,0,0.0952380952380952,0.125,0,0,0.5,0,0.5,0,0,0,0,0.0714285714285714,0,0,0,0,0,0,0,0.333333333333333,0,0,0,0.0454545454545455,0.333333333333333,1.66666666666667,0.0909090909090909,0.25,0,0,0,0,0,0,0,0,0,0.461538461538462,0.111111111111111,0,0,0,0.0625,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.222222222222222,0,0,0,0,0.5,0,0,0,0,0,0,0,0,0.3,0,0,0,0,0.351351351351351,0,0.818181818181818,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0454545454545455,0.1,0,0,0,0,0,0,0,0,0,0,0.0158730158730159,0,0.196969696969697,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.5,0.142857142857143,0,0.333333333333333,0,0,0,0,0,0,0,0,0,0,0,0,0.333333333333333,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0714285714285714,0.25,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.25,0,0.5,0,0,0,0,0,0,0,0,0.142857142857143,0,0,0,0,0.142857142857143,0,0,0,0,0,0,0,0,0,0,0.125,0,0,0,0,0,0,0,0,0.307692307692308,0,0,0,0,0.09375,0.5,0,0,0.5,0,0,0,0,0,0,0.172839506172839,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0833333333333333,0,0,0,0,0.5,0.125,0,0,0,0,0.0909090909090909,0,0,0,0.111111111111111,0.147058823529412,0.0833333333333333,0,0,0,0,0,0.111111111111111,0,0.129032258064516,0,0,0,0,1,0.201834862385321,0,0,0.5,0.0588235294117647,0,0.0909090909090909,0.0833333333333333,0,0,0.142857142857143,0,0.24390243902439,0,0.125,0,0,0.144736842105263,0,0,0.166666666666667,0.264705882352941,0,0,0,0.0384615384615385,0,0,0,0,0,0.111111111111111)#
#Revenue_Rest_of_costumers=c(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,120,0,0,0,56,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,10,0,0,0,160,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,28,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,56,0,0,0,0,0,0,0,0,0,0,0,0,0,80,0,0,0,0,75,0,262,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,28,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,90,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,835,0,0,0,0,0,44,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,32,0,0,32,0,0,249,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)#
#Revenue_Step1_Rest_of_costumers=c(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,60,0,0,0,11.2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.37037037037037,0,0,0,7.61904761904762,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1.75,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6.22222222222222,0,0,0,0,0,0,0,0,0,0,0,0,0,8,0,0,0,0,2.02702702702703,0,23.8181818181818,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.444444444444444,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12.8571428571429,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.333333333333333,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64.2307692307692,0,0,0,0,0,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.293577981651376,0,0,16,0,0,22.6363636363636,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)#

#Analysis#

Metrics_Step1_215934=summary(Step1_215934)
Metrics_Step1_215934
Metrics_Step3_215934=summary(Step3_215934)
Metrics_Step3_215934

Metrics_Step1_216178=summary(Step1_216178)
Metrics_Step1_216178
Metrics_Step3_216178=summary(Step3_216178)
Metrics_Step3_216178

Metrics_Step1_Rest_of_costumers=summary(Step1_Rest_of_costumers)
Metrics_Step1_Rest_of_costumers
Metrics_Step3_Rest_of_costumers=summary(Step3_Rest_of_costumers)
Metrics_Step3_Rest_of_costumers

#Garch Models#
#First, we will analyze the past behavior. Then we will make predictions for next 30 results#

library(rugarch)

#Costumer ID = 215934#

model<-ugarchspec(variance.model = list(model = "sGARCH", garchOrder = c(1, 1)), 
mean.model = list(armaOrder = c(0, 0), include.mean = FALSE), 
distribution.model = "norm")

modelCostumer215934<-ugarchfit(spec=model,data=Step3_215934)

#if we want to see the graph we can use: plot(modelCostumer215934)#

ugarchforecast(modelCostumer215934,n.ahead=30,data=Step3_215934)



#Costumer ID = 216178#

model<-ugarchspec(variance.model = list(model = "sGARCH", garchOrder = c(1, 1)), 
mean.model = list(armaOrder = c(0, 0), include.mean = FALSE), 
distribution.model = "norm")

modelCostumer216178<-ugarchfit(spec=model,data=Step3_216178)

#if we want to see the graph we can use: plot(modelCostumer216178)#

ugarchforecast(modelCostumer216178,n.ahead=30,data=Step3_216178)


#Costumer ID = Rest_of_costumers#

model<-ugarchspec(variance.model = list(model = "sGARCH", garchOrder = c(1, 1)), 
mean.model = list(armaOrder = c(0, 0), include.mean = FALSE), 
distribution.model = "norm")

modelRest_of_costumers<-ugarchfit(spec=model,data=Step3_Rest_of_costumers)

#if we want to see the graph we can use: plot(modelRest_of_costumers)#

ugarchforecast(modelRest_of_costumers,n.ahead=30,data=Step3_Rest_of_costumers)


#Regression Models#
#To make the prediction, we should replace in the formula the values for Step1#


#Costumer ID =215934#

result_215934 = lm(formula = Step3_215934 ~ Step1_215934)
result_215934
summary = summary(result_215934)
summary


#Costumer ID =216178#

result_216178 = lm(formula = Step3_216178 ~ Step1_216178)
result_216178
summary = summary(result_216178)
summary

#Rest_of_costumers#

result_Rest_of_costumers = lm(formula = Step3_Rest_of_costumers ~ Step1_Rest_of_costumers)
result_Rest_of_costumers
summary = summary(result_Rest_of_costumers)
summary

#Coefficients in the first regression were not significative (see p value and test t)#
